<div class="admin-dashboard-container">
  <h1 class="admin-dashboard-title">Media Sync Logs</h1>
  <%- include('../partials/messages') %>

  <div class="card shadow mb-4">
    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <h6 class="m-0 font-weight-bold text-primary">Synchronization Activity Log</h6>
      <a href="/admin/media" class="btn btn-secondary btn-sm">
        <i class="fas fa-arrow-left"></i> Back to Media Management
      </a>
    </div>
    <div class="card-body">
      <% if (logs && logs.length > 0) { %>
        <div class="table-responsive">
          <table class="table table-bordered">
            <thead class="thead-light">
              <tr>
                <th>Timestamp</th>
                <th>File Name</th>
                <th>File Type</th>
                <th>Operation</th>
                <th>Status</th>
                <th>Message</th>
                <th>Environment</th>
              </tr>
            </thead>
            <tbody>
              <% logs.forEach(log => { %>
                <tr class="<%= log.status === 'error' ? 'table-danger' : log.status === 'warning' ? 'table-warning' : 'table-success' %>">
                  <td><%= new Date(log.timestamp).toLocaleString() %></td>
                  <td>
                    <% if (log.fileName) { %>
                      <code><%= log.fileName %></code>
                    <% } else { %>
                      <em>N/A</em>
                    <% } %>
                  </td>
                  <td><%= log.fileType || 'N/A' %></td>
                  <td>
                    <span class="badge badge-info">
                      <%= log.operation %>
                    </span>
                  </td>
                  <td>
                    <span class="badge badge-<%= log.status === 'error' ? 'danger' : log.status === 'warning' ? 'warning' : 'success' %>">
                      <%= log.status %>
                    </span>
                  </td>
                  <td><%= log.message %></td>
                  <td><%= log.environment || 'unknown' %></td>
                </tr>
              <% }); %>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <% if (totalPages > 1) { %>
          <nav aria-label="Sync logs pagination">
            <ul class="pagination justify-content-center">
              <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                <a class="page-link" href="/admin/media/sync-logs?page=<%= currentPage - 1 %>&limit=<%= limit %>" tabindex="-1">Previous</a>
              </li>
              <% for (let i = 1; i <= totalPages; i++) { %>
                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                  <a class="page-link" href="/admin/media/sync-logs?page=<%= i %>&limit=<%= limit %>"><%= i %></a>
                </li>
              <% } %>
              <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                <a class="page-link" href="/admin/media/sync-logs?page=<%= currentPage + 1 %>&limit=<%= limit %>">Next</a>
              </li>
            </ul>
          </nav>
        <% } %>

      <% } else { %>
        <div class="alert alert-info">
          <i class="fas fa-info-circle"></i> No synchronization logs found.
        </div>
      <% } %>
    </div>
  </div>

  <!-- Summary Statistics -->
  <div class="row">
    <div class="col-md-3 mb-4">
      <div class="card border-left-success shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Successful Operations</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">
                <%= logs ? logs.filter(log => log.status === 'success').length : 0 %>
              </div>
            </div>
            <div class="col-auto">
              <i class="fas fa-check-circle fa-2x text-success"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card border-left-warning shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Warnings</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">
                <%= logs ? logs.filter(log => log.status === 'warning').length : 0 %>
              </div>
            </div>
            <div class="col-auto">
              <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card border-left-danger shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">Errors</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800">
                <%= logs ? logs.filter(log => log.status === 'error').length : 0 %>
              </div>
            </div>
            <div class="col-auto">
              <i class="fas fa-times-circle fa-2x text-danger"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-4">
      <div class="card border-left-info shadow h-100 py-2">
        <div class="card-body">
          <div class="row no-gutters align-items-center">
            <div class="col mr-2">
              <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Logs</div>
              <div class="h5 mb-0 font-weight-bold text-gray-800"><%= totalLogs || 0 %></div>
            </div>
            <div class="col-auto">
              <i class="fas fa-list fa-2x text-info"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>